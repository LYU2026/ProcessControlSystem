% N型热电偶  “温度-输出热电势”“赛贝克(seeback)系数曲线”曲线
%正向公式  N: E = sum(i=0 to n) c_i t^i.
%         K: E = sum(i=0 to n) c_i t^i + a0 exp(a1 (t - a2)^2).
clear all;
t1=-270:0;
c_i=[0.000000000000E+00,0.261591059620E-01,0.109574842280E-04,-0.938411115540E-07,-0.464120397590E-10,-0.263033577160E-11, -0.226534380030E-13,-0.760893007910E-16,-0.934196678350E-19];
c_i1=[0.000000000000E+00,0.259293946010E-01,0.157101418800E-04,0.438256272370E-07,-0.252611697940E-09,0.643118193390E-12,-0.100634715190E-14, 0.997453389920E-18,-0.608632456070E-21,0.208492293390E-24,-0.306821961510E-28];
c_i_k=[0.000000000000E+00,0.394501280250E-01,0.236223735980E-04,-0.328589067840E-06,-0.499048287770E-08,-0.675090591730E-10,-0.574103274280E-12,-0.310888728940E-14,-0.104516093650E-16,-0.198892668780E-19,-0.163226974860E-22];
c_i1_k=[-0.176004136860E-01,0.389212049750E-01,0.185587700320E-04,-0.994575928740E-07,0.318409457190E-09,-0.560728448890E-12, 0.560750590590E-15,-0.320207200030E-18, 0.971511471520E-22,-0.121047212750E-25];
a0 =  0.118597600000E+00;
a1 = -0.118343200000E-03;
a2 =  0.126968600000E+03;

% E1=c_i(1).*(t.^0);
% E2=c_i(2).*(t.^1);
% E3=c_i(3).*(t.^2);
% E4=c_i(4).*(t.^3);
% E5=c_i(5).*(t.^4);
% E6=c_i(6).*(t.^5);
% E7=c_i(7).*(t.^6);
% E8=c_i(8).*(t.^7);
% E9=c_i(9).*(t.^8);
% 
% E=E1+E2+E3+E4+E5+E6+E7+E8+E9;
 E1=0;
 for i=0:8
     E1=E1+c_i(i+1).*(t1.^i);
 end;
 
  E_K1=0;
 for i=0:10
     E_K1=E_K1+c_i_k(i+1).*(t1.^i);
 end;
 E_K1=E_K1+a0 *exp(a1 *(t1 - a2).^2);
t2=0:1300;
% E11=c_i1(1).*(t2.^0);
% E12=c_i1(2).*(t2.^1);
% E13=c_i1(3).*(t2.^2);
% E14=c_i1(4).*(t2.^3);
% E15=c_i1(5).*(t2.^4);
% E16=c_i1(6).*(t2.^5);
% E17=c_i1(7).*(t2.^6);
% E18=c_i1(8).*(t2.^7);
% E19=c_i1(9).*(t2.^8);
% E20=c_i1(10).*(t2.^9);
% E21=c_i1(11).*(t2.^10);
%  E2=E11+E12+E13+E14+E15+E16+E17+E18+E19+E20+E21;
 E2=0;
 for i=0:10
     E2=E2+c_i1(i+1).*(t2.^i);
 end;
 
 t3=0:1372;
  E_K2=0;
 for i=0:9
     E_K2=E_K2+c_i1_k(i+1).*(t3.^i);
 end;
  E_K2=E_K2+a0 *exp(a1 *(t3 - a2).^2);
  
t=[t1,t2];
E=[E1,E2];
t_k=[t1,t3];
E_K=[E_K1,E_K2];
 plot(t,E,t_k,E_K);
% else if(t<1300)
%         for i=0:10
%             E=c_i1(i+1).*(t.^i);
%         end;
%     end;

% plot(t,E,t2,E3);
xlabel('TEMPERATURE(^oC)');
ylabel('THERMOCOUPLE OUTPUT VOLTAGE(mV)');
title({'THERMOCOUPLE OUTPUT VOLTAGES FOR';' TYPE N and K THERAMOCOUPLES'},'fontsize',12);
%legend('type N','type K');
grid on;   
gtext('\leftarrow type N ');
gtext(' type K \rightarrow');

%“赛贝克(seeback)系数曲线”曲线
syms x;
E1_syms=subs(E1,t1,x);
E1_sysms_d=diff(E1_sysms);
E1_d=subs(E1_sysms_d,x,t1);
% E1_diff=diff(E1);
% E2_diff=diff(E2);
% E_K1_diff=diff(E_K1);
% E_K2_diff=diff(E_K2);
% E_diff=[E1_diff,E2_diff];
% figure; 
% plot(t,E_diff);
     